<!--"section-rapporte.html" 12.01.2026 -->

    <section id="rapporte-bereich" class="module" data-original-index="4">
      <div class="module-header"> 
        <h2>Tagesrapporte</h2>
      </div>

      <div class="module-content">

        <div class="section-buttons">
          <div class="button-container">
            <button class="exportRapport-button" onclick="openOverlayRapportCreate()">Rapport erstellen</button>
          </div>

          <input type="file" id="tagesrapport-upload-input" accept=".xls,.xlsx" style="display: none;">
          <button onclick="document.getElementById('tagesrapport-upload-input').click()" 
              class="upload-button">Rapport hochladen
          </button>
        </div>

        <div class="rapportfilter-group">
          <label for="rapport-year-select">Rapportjahr wählen:</label>
          <select id="rapport-year-select" onchange="ladeRapporte()">
            <option value="2025">2025</option>
            <option value="2026" selected>2026</option> 
          </select>

          <label style="margin-left: 15px;">
            <input type="checkbox" id="filter-original" checked onchange="filterRapporte()"> Originale
          </label>
          <label style="margin-left: 10px;">
            <input type="checkbox" id="filter-edit" checked onchange="filterRapporte()"> Bearbeitet
          </label>  

        </div>

        <div id="rapporte-tabelle">
        </div>
        
        <div id="rapportContainer" class="export-status-container">
          <p id="rapportMeldung"></p>
          <div id="rapportSpinner" class="spinner small hidden"></div>
        </div>

      </div>

    </section>

<!------Overlay Erstelle Rapport -->
<div id="overlayRapportCreate" class="standard-overlay">
  <div id="overlayRapportCreate-content" class="export-inhalt">
    <h2 id="overlayRapport-title" class="export-title" >Export / Tagesrapport</h2>

    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em;">
      <div style="display: flex; align-items: center; gap: 5px">
        <button onclick="zeigeVorherigenTagesrapportTermin()">&#9668;</button>
        <select id="tagesrapportTerminAuswahl" style="flex: 1"></select>
        <button onclick="zeigeNaechstenTagesrapportTermin()">&#9658;</button>
      </div>
    </div>
    
    <p id="TagesrapportInfo"></p>
    <p id="TagesrapportAnmeldungenInfo" class="scrollboxZusatzInfo" >0 Fahrer, 0 Ausgabe, 0 Registratur</p>
    <p id="TagesrapportAbmeldungenInfo" class="scrollboxZusatzInfo" >0 Abmeldungen, 0 ohneMeldung</p>


    <div class="scrollbox scrollbox-anmeldungen">
      <table id="scrollboxAnmeldungen-table"></table>
    </div>

    <div class="overlay-buttons">
      <button onclick="closeOverlay('overlayRapportCreate')">Schließen</button>
      <button onclick="createRapportAndExport('pdf')">PDF-Datei</button>
      <button onclick="createRapportAndExport('xlsx')">XLSX-Datei</button> 
    </div>

    <div id="rapportExportContainer" class="export-status-container">
      <p id="rapportStatusText"></p>
      <div id="rapportSpinner" class="spinner small hidden"></div>
    </div>

  </div>
</div>

<!------Overlay Lösche Rapport-->
<div id="overlayRapportDelete" class="standard-overlay">
  <div id="overlayRapportDelete-content" class="abfrage-inhalt">
    <h2 id="overlayRapportDelete-title" class="export-title">Rapport löschen</h2>
    
    <p id="overlayRapportMeldung"></p>
    
    <div class="overlay-buttons">
      <button onclick="closeOverlay('overlayRapportDelete')" class="cancel-button">Abbrechen</button>
      <button onclick="DeleteRapport()">Löschen</button>
    </div>

  </div>
</div>

<!------Overlay Edit Rapport Conflict-->
<div id="overlayEditConflict" class="standard-overlay">
  <div class="abfrage-inhalt">
    <h2>Bearbeitung</h2>
    <p id="editConflictMeldung"></p>
    <div class="overlay-buttons">
      <button onclick="handleEditChoice('overwrite')" class="cancel-button">Neu vom Original</button>
      <button onclick="handleEditChoice('continue')">Weiter bearbeiten</button>
      <button onclick="closeOverlay('overlayEditConflict')">Abbrechen</button>
    </div>
  </div>
</div>